(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[995],{3628:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/sales-dashboard",function(){return s(9934)}])},9934:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var r=s(7876),a=s(4232);function l(){var e;let[t,s]=(0,a.useState)(null),[l,n]=(0,a.useState)(!0),[d,i]=(0,a.useState)({}),[c,o]=(0,a.useState)({}),[x,m]=(0,a.useState)({}),h=async()=>{n(!0);try{let e=await fetch("/api/pos-sales"),t=await e.json();s(t)}catch(e){console.error("Fout bij ophalen verkoopdata:",e)}finally{n(!1)}},p=async e=>{let t=d[e];if(i(s=>({...s,[e]:!t})),!t&&!c[e]){m(t=>({...t,[e]:!0}));try{let t=await fetch("/api/order-lines?id=".concat(e)),s=await t.json();o(t=>({...t,[e]:s.lines||[]}))}catch(t){console.error("Fout bij laden orderlijnen van order ".concat(e,":"),t)}finally{m(t=>({...t,[e]:!1}))}}};return(0,a.useEffect)(()=>{h();let e=setInterval(h,6e4);return()=>clearInterval(e)},[]),(0,r.jsx)("div",{className:"min-h-screen bg-gray-100 p-4 sm:p-8 font-sans",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto bg-white shadow-xl rounded-2xl p-4 sm:p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("h1",{className:"text-xl sm:text-2xl font-bold",children:["\uD83E\uDDFE Kassa ",(()=>{var e;if(!(null==t||null==(e=t.orders)?void 0:e.length))return"";let s=new Intl.DateTimeFormat("nl-BE"),r=Array.from(new Set(t.orders.map(e=>s.format(new Date(e.timestamp+"Z"))))).sort((e,t)=>new Date(e).getTime()-new Date(t).getTime());return 1===r.length?r[0]:"".concat(r[0]," – ").concat(r[r.length-1])})()]}),(0,r.jsx)("button",{onClick:h,className:"text-sm px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl shadow",children:"\uD83D\uDD04 Refresh"})]}),l&&(0,r.jsx)("p",{children:"⏳ Gegevens laden..."}),!l&&t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mb-6 space-y-1 text-sm sm:text-base",children:[(0,r.jsxs)("p",{className:"text-gray-600",children:["\uD83D\uDCE6 Aantal verkopen: ",(0,r.jsx)("strong",{children:t.orders.length})]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["\uD83D\uDCB6 Totale omzet: ",(0,r.jsxs)("strong",{children:["€ ",t.total.toFixed(2)]})]})]}),(0,r.jsxs)("table",{className:"hidden sm:table w-full text-left border-t border-gray-200 mb-4",children:[(0,r.jsx)("thead",{className:"text-gray-600 uppercase text-sm",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"py-2",children:"Tijd"}),(0,r.jsx)("th",{className:"py-2",children:"Klant"}),(0,r.jsx)("th",{className:"py-2 text-right",children:"Bedrag"})]})}),(0,r.jsx)("tbody",{children:t.orders.map(e=>{var t;return(0,r.jsxs)(a.Fragment,{children:[(0,r.jsxs)("tr",{onClick:()=>p(e.id),className:"cursor-pointer border-t border-gray-100 hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"py-2",children:new Intl.DateTimeFormat("nl-BE",{timeZone:"Europe/Brussels",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date(e.timestamp+"Z"))}),(0,r.jsx)("td",{className:"py-2",children:e.partner||(0,r.jsx)("span",{className:"text-gray-400",children:"–"})}),(0,r.jsxs)("td",{className:"py-2 text-right font-medium",children:["€ ",e.total.toFixed(2)]})]}),d[e.id]&&(0,r.jsx)("tr",{className:"bg-gray-50 border-t border-gray-200",children:(0,r.jsx)("td",{colSpan:3,className:"p-4",children:x[e.id]?(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Laden..."}):(null==(t=c[e.id])?void 0:t.length)?(()=>{let t=c[e.id],s=t.some(e=>e.qty>1);return(0,r.jsxs)("table",{className:"w-full text-sm text-gray-700",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-gray-300 text-left",children:[(0,r.jsx)("th",{className:"py-1 font-semibold",children:"Product"}),s&&(0,r.jsx)("th",{className:"py-1",children:"Aantal \xd7 Prijs"}),(0,r.jsx)("th",{className:"py-1 text-right font-semibold",children:"Totaal"})]})}),(0,r.jsx)("tbody",{children:t.map((e,t)=>(0,r.jsxs)("tr",{className:"border-t border-gray-200",children:[(0,r.jsx)("td",{className:"py-1 font-semibold",children:e.product_name}),s&&(0,r.jsx)("td",{className:"py-1",children:e.qty>1?"".concat(e.qty," \xd7 € ").concat(e.price_unit.toFixed(2)):"€ ".concat(e.price_unit.toFixed(2))}),(0,r.jsxs)("td",{className:"py-1 text-right font-bold",children:["€ ",(e.qty*e.price_unit).toFixed(2)]})]},t))})]})})():(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Geen orderlijnen gevonden."})})})]},e.id)})})]}),(0,r.jsx)("div",{className:"sm:hidden space-y-3",children:t.orders.map(e=>{var t;let s=new Intl.DateTimeFormat("nl-BE",{timeZone:"Europe/Brussels",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date(e.timestamp+"Z"));return(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl",children:[(0,r.jsxs)("div",{className:"px-4 py-3 cursor-pointer",onClick:()=>p(e.id),children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{children:s}),(0,r.jsxs)("span",{className:"text-right font-bold text-blue-800",children:["€ ",e.total.toFixed(2)]})]}),(0,r.jsx)("div",{className:"text-gray-500 text-sm mt-1",children:e.partner||(0,r.jsx)("span",{className:"text-gray-300",children:"Geen klant"})})]}),d[e.id]&&(0,r.jsx)("div",{className:"border-t border-gray-200 px-4 py-3 text-sm bg-gray-50 rounded-b-xl",children:x[e.id]?(0,r.jsx)("p",{className:"text-gray-500",children:"Laden..."}):(null==(t=c[e.id])?void 0:t.length)?(()=>{let t=c[e.id],s=t.some(e=>e.qty>1);return(0,r.jsxs)("table",{className:"w-full text-sm text-gray-700",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-gray-300 text-left",children:[(0,r.jsx)("th",{className:"py-1 font-semibold",children:"Product"}),s&&(0,r.jsx)("th",{className:"py-1",children:"Aantal \xd7 Prijs"}),(0,r.jsx)("th",{className:"py-1 text-right font-semibold",children:"Totaal"})]})}),(0,r.jsx)("tbody",{children:t.map((e,t)=>(0,r.jsxs)("tr",{className:"border-t border-gray-200",children:[(0,r.jsx)("td",{className:"py-1 font-semibold",children:e.product_name}),s&&(0,r.jsx)("td",{className:"py-1",children:e.qty>1?"".concat(e.qty," \xd7 € ").concat(e.price_unit.toFixed(2)):"€ ".concat(e.price_unit.toFixed(2))}),(0,r.jsxs)("td",{className:"py-1 text-right font-bold",children:["€ ",(e.qty*e.price_unit).toFixed(2)]})]},t))})]})})():(0,r.jsx)("p",{className:"text-gray-500",children:"Geen orderlijnen gevonden."})})]},e.id)})})]}),!l&&t&&(null==(e=t.orders)?void 0:e.length)===0&&(0,r.jsx)("p",{className:"text-gray-500 mt-4",children:"Er zijn nog geen verkopen geregistreerd in deze sessie."}),!l&&!(null==t?void 0:t.session_id)&&(0,r.jsx)("p",{className:"text-red-500 mt-4",children:"⚠️ Geen actieve POS-sessie gevonden."})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(3628)),_N_E=e.O()}]);