(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{753:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(7876),r=s(4232),l=s(9099),n=s(2351);function o(){let e=(0,l.useRouter)(),[t,s]=(0,r.useState)(null),[o,d]=(0,r.useState)(""),[i,c]=(0,r.useState)(null),[m,h]=(0,r.useState)(!0),[u,x]=(0,r.useState)({}),[p,b]=(0,r.useState)({}),[g,j]=(0,r.useState)({});(0,r.useEffect)(()=>{{let t=localStorage.getItem("odoo_uid"),a=localStorage.getItem("odoo_pass");t&&a?(s(Number(t)),d(a)):e.push("/")}},[e]);let y=(0,r.useCallback)(async()=>{if(t&&o){h(!0);try{let e=await (0,n.C)({model:"pos.session",method:"search_read",args:[[["state","=","opened"]],["id","name"],0,1,"id desc"],uid:t,password:o});if(!e.length)return void c({session_id:0,session_name:"",total:0,orders:[]});let s=e[0],a=(await (0,n.C)({model:"pos.order",method:"search_read",args:[[["session_id","=",s.id]],["id","amount_total","date_order","partner_id"]],uid:t,password:o})).map(e=>{var t;return{id:e.id,total:e.amount_total,timestamp:e.date_order,partner:(null==(t=e.partner_id)?void 0:t[1])||null}}),r=a.reduce((e,t)=>e+t.total,0);c({session_id:s.id,session_name:s.name,total:r,orders:a})}catch(e){console.error("Fout bij ophalen POS-data:",e)}finally{h(!1)}}},[t,o]);(0,r.useEffect)(()=>{if(t&&o){y();let e=setInterval(y,6e4);return()=>clearInterval(e)}},[t,o,y]);let f=async e=>{let t=u[e];if(x(s=>({...s,[e]:!t})),!t&&!p[e]){j(t=>({...t,[e]:!0}));try{let t=await fetch("/api/order-lines?id=".concat(e)),s=await t.json();b(t=>({...t,[e]:s.lines||[]}))}catch(t){console.error("Fout bij laden orderlijnen van order ".concat(e,":"),t)}finally{j(t=>({...t,[e]:!1}))}}};return(0,a.jsx)("div",{className:"min-h-screen bg-gray-100 p-4 sm:p-8 font-sans",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto bg-white shadow-xl rounded-2xl p-4 sm:p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("h1",{className:"text-xl sm:text-2xl font-bold",children:["\uD83E\uDDFE Kassa ",(()=>{var e;if(!(null==i||null==(e=i.orders)?void 0:e.length))return"";let t=new Intl.DateTimeFormat("nl-BE"),s=Array.from(new Set(i.orders.map(e=>t.format(new Date(e.timestamp+"Z"))))).sort((e,t)=>new Date(e).getTime()-new Date(t).getTime());return 1===s.length?s[0]:"".concat(s[0]," – ").concat(s[s.length-1])})()]}),(0,a.jsx)("button",{onClick:y,className:"text-sm px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-xl shadow",children:"\uD83D\uDD04 Refresh"})]}),m&&(0,a.jsx)("p",{children:"⏳ Gegevens laden..."}),!m&&i&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6 space-y-1 text-sm sm:text-base",children:[(0,a.jsxs)("p",{className:"text-gray-600",children:["\uD83D\uDCE6 Aantal verkopen: ",(0,a.jsx)("strong",{children:i.orders.length})]}),(0,a.jsxs)("p",{className:"text-gray-600",children:["\uD83D\uDCB6 Totale omzet: ",(0,a.jsxs)("strong",{children:["€ ",i.total.toFixed(2)]})]})]}),(0,a.jsx)("div",{className:"hidden sm:table w-full text-left border-t border-gray-200 mb-2",children:(0,a.jsx)("div",{className:"table-header-group text-gray-600 uppercase text-sm",children:(0,a.jsxs)("div",{className:"table-row",children:[(0,a.jsx)("div",{className:"table-cell py-2",children:"Tijd"}),(0,a.jsx)("div",{className:"table-cell py-2",children:"Klant"}),(0,a.jsx)("div",{className:"table-cell py-2 text-right",children:"Bedrag"})]})})}),(0,a.jsx)("div",{className:"space-y-2",children:i.orders.map(e=>{var t;let s=new Intl.DateTimeFormat("nl-BE",{timeZone:"Europe/Brussels",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date(e.timestamp+"Z"));return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{onClick:()=>f(e.id),className:"border border-gray-200 sm:table-row w-full bg-white rounded-xl sm:rounded-none shadow-sm sm:shadow-none sm:table table-fixed cursor-pointer hover:bg-gray-50",children:(0,a.jsxs)("div",{className:"flex sm:table-row flex-col sm:flex-row sm:table w-full px-4 sm:px-0 py-3 sm:py-0",children:[(0,a.jsx)("div",{className:"sm:table-cell font-medium",children:s}),(0,a.jsx)("div",{className:"sm:table-cell text-gray-700",children:e.partner||(0,a.jsx)("span",{className:"text-gray-400",children:"–"})}),(0,a.jsxs)("div",{className:"sm:table-cell text-right font-bold text-blue-800",children:["€ ",e.total.toFixed(2)]})]})}),u[e.id]&&(0,a.jsx)("div",{className:"bg-gray-50 border border-t-0 border-gray-200 rounded-b-xl px-4 py-3",children:g[e.id]?(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Laden..."}):(null==(t=p[e.id])?void 0:t.length)?(0,a.jsxs)("table",{className:"w-full text-sm text-gray-700",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-300 text-left",children:[(0,a.jsx)("th",{className:"py-1 font-semibold",children:"Product"}),(0,a.jsx)("th",{className:"py-1",children:"Aantal \xd7 Prijs"}),(0,a.jsx)("th",{className:"py-1 text-right font-semibold",children:"Totaal"})]})}),(0,a.jsx)("tbody",{children:p[e.id].map((e,t)=>(0,a.jsxs)("tr",{className:"border-t border-gray-200",children:[(0,a.jsx)("td",{className:"py-1 font-semibold",children:e.product_name}),(0,a.jsx)("td",{className:"py-1",children:e.qty>1?"".concat(e.qty," \xd7 €").concat(e.price_unit.toFixed(2)):""}),(0,a.jsxs)("td",{className:"py-1 text-right font-bold",children:["€ ",(e.qty*e.price_unit).toFixed(2)]})]},t))})]}):(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Geen orderlijnen gevonden."})})]},e.id)})})]})]})})}},2351:(e,t,s)=>{"use strict";s.d(t,{C:()=>n,F:()=>l});let a="https://www.babetteconcept.be/jsonrpc",r="babetteconcept";async function l(e,t){let s={jsonrpc:"2.0",method:"call",params:{service:"common",method:"authenticate",args:[r,e,t,{}]},id:Date.now()};try{var l;let e=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return null!=(l=(await e.json()).result)?l:null}catch(e){return console.error("❌ Login fetch error:",e),null}}async function n(e){let{model:t,method:s,args:l,uid:n,password:o}=e,d={jsonrpc:"2.0",method:"call",params:{service:"object",method:"execute_kw",args:[r,n,o,t,s,l]},id:Date.now()};try{let e=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),t=await e.json();if(t.error)throw Error(JSON.stringify(t.error));return t.result}catch(e){throw console.error("❌ Odoo call error:",e),e}}},7580:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return s(753)}])},9099:(e,t,s)=>{e.exports=s(8253)}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(7580)),_N_E=e.O()}]);